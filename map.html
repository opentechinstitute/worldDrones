<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>WoD</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.js'></script>
<script src='data_join_country2.geojson'></script>
<script src="jquery-2.1.1.min.js"></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.css' rel='stylesheet' />
<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>

<div id='map'></div>
<script>

L.mapbox.accessToken = 'pk.eyJ1IjoibmV3YW1lcmljYSIsImEiOiIyM3ZnYUtrIn0.57fFgg_iM7S1wLH2GQC71g';
var map = L.mapbox.map('map', 'newamerica.l89jcfpc');
map.scrollWheelZoom.disable();

	function onEachFeature(feature, layer) {

		var popupContent = "";
		if (feature.properties) {
			popupContent += "<span style=\"color:#000;\" ><strong>" + feature.properties.NAME 
            + "</strong><br />" + feature.properties.woddata219_desc;
            //+ "<br/><strong>Source:</strong> " + feature.properties.woddata219_source;

		}
		layer.bindPopup(popupContent);
	} 	

    //"#3182bd", "#6baed6", "#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b",
  //"#fdd0a2", "#31a354", "#74c476", "#a1d99b", "#c7e9c0", "#756bb1", "#9e9ac8",
  //"#bcbddc", "#dadaeb", "#636363", "#969696", "#bdbdbd", "#d9d9d9"
	
    //'Used drones in combat':
    var combat =  L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_ii_plus){
                    return feature.properties.woddata219_used_armed_drones_in_combat == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#081d58'};
            }
    });

    //'Has armed drones': 
    var armed = L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_ii_plus){
                    return feature.properties.woddata219_have_armed_drones == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#225ea8'};
            }
    });

    //'Developing armed drones': 
    var developing_armed_drones = L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_ii_plus){
                    return feature.properties.woddata219_developing_armed_drones == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#41b6c4'};
            }
    });

    //domestic
    var domestic_prod = L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_ii_plus){
                    return feature.properties.woddata219_domestic_production == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#238443'};
            }
    });

    //'Tier i': 
    var tier1 = L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_i){
                    return feature.properties.woddata219_tier_i == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#e6550d'};
            }
    });

    //'Tier ii': 
    var tier2 = L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_ii){
                    return feature.properties.woddata219_tier_ii == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#fd8d3c'};
            }
    });

    //'Tier ii Plus': 
    var tier2plus = L.geoJson(data, {
            onEachFeature: onEachFeature,
            filter:function (feature, layer) {
                if(feature.properties.woddata219_tier_ii_plus){
                    return feature.properties.woddata219_tier_ii_plus == 1;
                }
                return false;
            },
            style: function (feature) {
                return {color: '#bd0026'};
            }
    });


	L.control.layers({
        'Used drones in combat': combat,
        'Has armed drones': armed,
        'Developing armed drones': developing_armed_drones,
        'Domestically producing drones': domestic_prod.addTo(map),
        'Tier I': tier1,
        'Tier II': tier2,
        'Tier II+': tier2plus 
    },null,{collapsed:false}).addTo(map);
//});

</script>


</body>
</html>
