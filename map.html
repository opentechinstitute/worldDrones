<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>WoD</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.js'></script>
<script src='countries.geojson'></script>
<script src="jquery-2.1.1.min.js"></script>
<script src="ckan-basics.js"></script>
<script src="auth.js"></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.css' rel='stylesheet' />

<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>


<script src='https://api.tiles.mapbox.com/mapbox.js/plugins/turf/v1.4.0/turf.min.js'></script>
<div id='map'></div>
<script>

var data = firequery();
//console.log(data);

L.mapbox.accessToken = 'pk.eyJ1IjoibmV3YW1lcmljYSIsImEiOiIyM3ZnYUtrIn0.57fFgg_iM7S1wLH2GQC71g';
var map = L.mapbox.map('map', 'newamerica.l89jcfpc');

//what to do with each feature
	function onEachFeature(data, feature, layer) {
		for(i = 0; i < data.length; i++){
			if(data[i].name == feature.properties.name){
				console.log("true");
			}
		}

		var popupContent = "";
		if (feature.properties) {
			popupContent += "<span style=\"color:#000;\" ><strong>Name:</strong> " + feature.properties.name + 
			"<br/><strong>Source:</strong> " + feature.properties.source;

		}
		layer.bindPopup(popupContent);
	} 


	//map.featureLayer.on('ready', function() {
    	//var hull = turf.concave(map.featureLayer.getGeoJSON(), 3);
    	//L.mapbox.featureLayer(hull).addTo(map);
	//});

	L.geoJson(countries, {
    	onEachFeature: onEachFeature,
	}).addTo(map);

	//map.on('click', onClick);

 /*   L.control.layers({
    'Base Map': L.mapbox.tileLayer('examples.map-i87786ca').addTo(map),
    'Grey Map': L.mapbox.tileLayer('examples.map-20v6611k')
	}, {
     'Bike Stations': L.mapbox.tileLayer('examples.bike-locations'),
     'Bike Lanes': L.mapbox.tileLayer('examples.bike-lanes')
	}).addTo(map);*/
</script>


</body>
</html>
